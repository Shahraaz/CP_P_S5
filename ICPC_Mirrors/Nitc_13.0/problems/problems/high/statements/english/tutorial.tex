\begin{tutorial}{High Load Database}

{
    \parindent=1cm
    \begin{tabular}{l@{\extracolsep{1cm}}l}
         Идея задачи: & Виталий Аксенов\\
         Условие: & Георгий Корнеев\\
         Проверяющая программа: & Нияз Нигматуллин\\
         Тесты: & Нияз Нигматуллин\\
     \end{tabular}
}


Пусть $\overline{a} = \max\limits_{i=1}^n a_i$. Заметим, что при $t < \overline{a}$, то выполнить скрипт до конца невозможно.

Пусть $A = \sum_{i=1}^n a_i$. Предподсчитаем $f[j]$~--- номер транзации, в которой находится $j$-й запрос ($j=1..A$). Будем жадно объединять транзакции в блоки, начиная я первого.
Тогда в первый блок попадут транзакции с 1 по $f[t]-1=b_1$, во второй блок попадут транзакции $b_1..f[b_2+t]-1=b_2$, в $k-й$ блок~--- транзакции $b_{k-1}..f[b_{k-1}+t]-1=b_k$.

Посчитаем время, которое потребуется на симуляцию. Для этого разделим транзакции на \textit{большие}, для которых $2t > a_i$ и \textit{малые}, для которых $2t \le a_i$. Пусть больших транзакций $M$ ($M < 2A/t$), тогда, число блоков содержащих большие транзакции,  и соседних с ними не более $3M=O(\frac{A}{t})$. Общее число запросов в блоке, содержащем только малые транзакции, за которым следует блок так же содержащий только малые транзакции не может быть меньше $t/2$, так как иначем мы бы могли взять еще одну малую транзакцию из следующего блока. Суммарная длина малых транзакций не превышает $A$, то число блоков, состоящих только из малых транзакций не превышает $\frac{2A}{t}$. Таким образом, суммарное время обработки всех блоков составит $O(\frac{A}{t})$.

Таким образом, мы можем посчитать число блоков для $t=1..\overline{a}$ за время $O(\sum_{t=1}^{\overline{a}}{\frac{A}{t}}) = O(A \log \overline{a})$.


\end{tutorial}
