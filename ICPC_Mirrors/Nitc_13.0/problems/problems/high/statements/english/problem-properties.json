{"scoring":null,"notes":"","legend":"Henry profiles a high load database migration script. The script is the list of $n$ transactions. The $i$-th transaction consists of $a_i$ queries. Henry wants to split the script to the minimum possible number of batches, where each batch contains either one transaction or a sequence of consecutive transactions, and the total number of queries in each batch does not exceed $t$.\r\n\r\nUnfortunately, Henry does not know the exact value of $t$ for the production database, so he is going to estimate the minimum number of batches for $q$ possible values of $t$: $t_1, t_2, \\ldots, t_q$. Help Henry to calculate the number of transactions for each of them.","authorLogin":"niyaznigmatul","language":"english","timeLimit":2000,"output":"Output $q$ lines. The $i$-th line should contain the minimum possible number of batches, having at most $t_i$ queries each. If it is not possible to split the script into the batches for some $t_i$, output ``\\t{Impossible}'' instead.\r\n\r\nRemember that you may not rearrange transactions, only group consecutive transactions in a batch.","inputFile":"stdin","outputFile":"stdout","input":"The first line contains a single integer $n$~--- the number of transactions in the migration script ($1 \\le n \\le 200\\,000$).\r\n\r\nThe second line consists of $n$ integers $a_1, a_2, \\ldots, a_n$~--- the number of queries in each transaction ($1 \\le a_i$; $\\sum{a_i} \\le 10^6$).\r\n\r\nThe third line contains an integer $q$~--- the number of queries ($1 \\le q \\le 100\\,000$).\r\n\r\nThe fourth line contains $q$ integers $t_1, t_2, \\ldots, t_q$ ($1 \\le t_i \\le \\sum{a_i}$).","authorName":"Niyaz Nigmatullin","sampleTests":[{"output":"2\r\nImpossible\r\n4\r\n5\r\n4\r\n3\r\n3\r\n3\r\n","input":"6\r\n4 2 3 1 3 4\r\n8\r\n10 2 5 4 6 7 8 8\r\n","inputFile":"example.01","outputFile":"example.01.a"}],"name":"High Load Database","interaction":null,"memoryLimit":536870912,"tutorial":"{\r\n    \\parindent=1cm\r\n    \\begin{tabular}{l@{\\extracolsep{1cm}}l}\r\n         Idea: & Vitalik Aksenov\\\\\r\n         Statement: & Georgiy Korneev\\\\\r\n         Checker: & Niyaz Nigmatullin\\\\\r\n         Tests: & Niyaz Nigmatullin\\\\\r\n     \\end{tabular}\r\n}\r\n\r\nIf $t < \\max\\limits_{i=1}^n a_i$, then it's impossible to split.\r\n\r\nLet's calculate $b_i = \\sum\\limits_{j=1}^i a_j$.\r\n\r\nTo simulate the transactions for single batch, we should calculate the transaction at which we stop, if we start from the beginning and have time limit $t$~--- $s_t$, for each $t \\le \\sum{a_i}$. Then if we know the batch starts at position $i$ and have time limit $t$, we would stop on transaction $s_{t+b_{i-1}}$.\r\n\r\nThen if we start simulating for some $t$, it would take at most $\\frac{2 \\cdot \\sum{a_i}}{t}$ steps. Because if $\\sum\\limits_{i=L}^R a_i \\le t$ and $\\sum\\limits_{i=L}^{R+1} a_i > t$, then after two steps we would take all elements up to $R+1$, since $a_{R+1} \\le t$ (otherwise, it wouldn't be possible).\r\n\r\nSo, if we want to calculate the minimum number of batches for each $t \\le \\sum{a_i}$, it would take $\\sum\\limits_{t=\\max{a_i}}^{\\sum{a_i}} \\frac{2 \\cdot \\sum{a_i}}{t} = \\mathcal{O}(\\sum{a_i} \\log{\\sum{a_i}})$.\r\n\r\nThe solution is to simulate using $s$ and $b$. If several queries with same $t$ are given, calculate solution for that $t$ only once.\r\n\r\n{\r\n    \\parindent=1cm\r\n    \\begin{tabular}{l@{\\extracolsep{1cm}}l}\r\n         Идея задачи: & Виталий Аксенов\\\\\r\n         Условие: & Георгий Корнеев\\\\\r\n         Проверяющая программа: & Нияз Нигматуллин\\\\\r\n         Тесты: & Нияз Нигматуллин\\\\\r\n     \\end{tabular}\r\n}\r\n\r\n\r\nПусть $\\overline{a} = \\max\\limits_{i=1}^n a_i$. Заметим, что при $t < \\overline{a}$, то выполнить скрипт до конца невозможно.\r\n\r\nПусть $A = \\sum_{i=1}^n a_i$. Предподсчитаем $f[j]$~--- номер транзации, в которой находится $j$-й запрос ($j=1..A$). Будем жадно объединять транзакции в блоки, начиная я первого. \r\nТогда в первый блок попадут транзакции с 1 по $f[t]-1=b_1$, во второй блок попадут транзакции $b_1..f[b_2+t]-1=b_2$, в $k-й$ блок~--- транзакции $b_{k-1}..f[b_{k-1}+t]-1=b_k$. \r\n\r\nПосчитаем время, которое потребуется на симуляцию. Для этого разделим транзакции на \\textit{большие}, для которых $2t > a_i$ и \\textit{малые}, для которых $2t \\le a_i$. Пусть больших транзакций $M$ ($M < 2A/t$), тогда, число блоков содержащих большие транзакции,  и соседних с ними не более $3M=O(\\frac{A}{t})$. Общее число запросов в блоке, содержащем только малые транзакции, за которым следует блок так же содержащий только малые транзакции не может быть меньше $t/2$, так как иначем мы бы могли взять еще одну малую транзакцию из следующего блока. Суммарная длина малых транзакций не превышает $A$, то число блоков, состоящих только из малых транзакций не превышает $\\frac{2A}{t}$. Таким образом, суммарное время обработки всех блоков составит $O(\\frac{A}{t})$.\r\n\r\nТаким образом, мы можем посчитать число блоков для $t=1..\\overline{a}$ за время $O(\\sum_{t=1}^{\\overline{a}}{\\frac{A}{t}}) = O(A \\log \\overline{a})$.\r\n"}