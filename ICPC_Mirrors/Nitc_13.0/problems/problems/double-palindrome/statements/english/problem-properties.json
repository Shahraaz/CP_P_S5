{"scoring":null,"notes":"In the first example the strings to be counted are: \\texttt{a}, \\texttt{b}, \\texttt{c}, \\texttt{aa}, \\texttt{ab}, \\texttt{ac}, \\texttt{ba}, \\texttt{bb}, \\texttt{bc}, \\texttt{ca}, \\texttt{cb}, \\texttt{cc}, \\texttt{aaa}, \\texttt{aab}, \\texttt{aac}, \\texttt{aba}, \\texttt{abb}, \\texttt{aca}, \\texttt{acc}, \\texttt{baa}, \\texttt{bab}, \\texttt{bba}, \\texttt{bbb}, \\texttt{bbc}, \\texttt{bcb}, \\texttt{bcc}, \\texttt{caa}, \\texttt{cac}, \\texttt{cbb}, \\texttt{cbc}, \\texttt{cca}, \\texttt{ccb}, \\texttt{ccc}.","legend":"A \\textit{palindrome} is a string that reads the same backward as forward. For example, \\texttt{rotator}, \\texttt{lil} and \\texttt{abba} are palindromes, but \\texttt{shalash} is not.\r\n\r\nA \\textit{double palindrome} is a string that is either a palindrome or a concatenation of two (not necessarily distinct) palindromes. For example, \\texttt{susanna}, \\texttt{potato} and \\texttt{abba} are double palindromes, but \\texttt{zzyzx} and \\texttt{abaabb} are not.\r\n\r\nDalila has just realized that her name is a double palindrome! Now she wonders how many non-empty strings of length at most $n$ composed of the first $k$ English letters have the same property. Help her find this number and output it modulo $998\\,244\\,353$.\r\n","authorLogin":"tourist","language":"english","timeLimit":2000,"output":"Output the number of non-empty double palindromes of length at most $n$ composed of the first $k$ English letters, modulo $998\\,244\\,353$.","inputFile":"stdin","outputFile":"stdout","input":"The only line contains two integers $n$ and $k$~--- the maximum length of the string and the size of the alphabet ($1 \\le n \\le 10^5$; $1 \\le k \\le 26$).","authorName":"Gennady Korotkevich","sampleTests":[{"output":"33\r\n","input":"3 3\r\n","inputFile":"example.01","outputFile":"example.01.a"},{"output":"114\r\n","input":"6 2\r\n","inputFile":"example.02","outputFile":"example.02.a"},{"output":"83419789\r\n","input":"42 7\r\n","inputFile":"example.03","outputFile":"example.03.a"}],"name":"Double Palindrome","interaction":null,"memoryLimit":536870912,"tutorial":"{\r\n    \\parindent=1cm\r\n    \\begin{tabular}{l@{\\extracolsep{1cm}}l}\r\n         Idea: & Gennady Korotkevich\\\\\r\n         Statement: & Gennady Korotkevich\\\\\r\n         Checker: & Gennady Korotkevich\\\\\r\n         Tests: & Gennady Korotkevich\\\\\r\n     \\end{tabular}\r\n}\r\n\r\n{\r\n    \\parindent=1cm\r\n    \\begin{tabular}{l@{\\extracolsep{1cm}}l}\r\n         Идея задачи: & Геннадий Короткевич\\\\\r\n         Условие: & Геннадий Короткевич\\\\\r\n         Проверяющая программа: & Геннадий Короткевич\\\\\r\n         Тесты: & Геннадий Короткевич\\\\\r\n     \\end{tabular}\r\n}\r\n\r\nДля того, чтобы посчитать число двойных палиндромов длины $n$, посчитаем вспомогательную функцию $R(n, k)$~--- число способов построить строку длины $n$ над алфавитом размера $k$ в виде конкатенации двух палиндромов. Для этого переберём длину первого палиндрома от $0$ до $n - 1$. Так как число палиндромов длины $l$ над алфавитом размера $k$ равно $k^{\\lceil l / 2\\rceil}$, то получим $R(n, k) = \\sum_{l=0}^{n-1} k^{\\lceil l / 2\\rceil} \\cdot k^{\\lceil (n - l) / 2\\rceil}$. \r\n\r\nОднако при таком разбиении некоторые двойные палиндромы будут посчитаны два раза, например строку ``\\t{abacabacabac}'' можно представить как пару палиндромов тремя способами: ``\\t{aba$|$cabacabac}'', ``\\t{abacaba$|$cabac}'' и ``\\t{abacabacaba$|$c}''. Таким образом, мы посчитаем эту строку три раза.\r\n\r\nЗаметим, что строка $s$ длины $n$ является двойным палиндромом тогда и только тогда, когда $s$ равна циклическому сдвигу развернутой строки $s$, т.~е. существует число $k$ (которое на самом деле равно длине первого из палиндромов, на которые разбивается $s$) такое, что $\\forall i: s_i = s_{k - 1 - i \\mod n}$.\r\n\r\nПусть для строки $s$ нашлось два способа разбить её на два палиндрома, при этом длины первого палиндрома в этих способах равны $l_1$ и $l_2$ соответственно ($l_1 < l_2$). Тогда $s_i = s_{l_1 - 1 - i \\mod n} = s_{l_2 - l_1 + i \\mod n}$, то есть строка $s$ периодична с периодом $\\l_2 - l_1$, и даже с периодом $\\gcd(n, l_2 - l_1)$. Пусть $p$~--- минимальный период двойного палиндрома $s$, тогда $p$~--- тоже двойной палиндром, и $p$ представляется в виде конкатенации не более двух палиндромов единственным способом, при этом в $R(n, k)$ мы посчитали $s$ ровно $\\frac{|s|}{|p|}$ раз.\r\n\r\nДавайте посчитаем значение $D(n, k)$~--- количество двойных палиндромов длины $n$ над алфавитом размера $k$, которые разбиваются на два палиндрома единственным способом. Для $D(n, k)$ верна следующая рекуррентная формула:\r\n\r\n$$ D(n, k) = R(n, k) - \\sum_{\\substack{l|n\\\\l<n}} \\frac{n}{l} D(l, k) $$\r\n\r\nТогда ответом будет $\\sum\\limits_{n} \\sum\\limits_{l|n} D(l, k)$. Суммарное время работы составляет $\\mathcal{O}(n \\log n)$.\r\n"}